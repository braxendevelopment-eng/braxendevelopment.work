<!-- Quarter Club Form -->
<form id="quarterclub-form">
  <label for="business-name">Business Name:</label>
  <input type="text" id="business-name" required>

  <label for="business-ein">EIN:</label>
  <input type="text" id="business-ein" placeholder="XX-XXXXXXX" required>

  <label for="business-email">Email:</label>
  <input type="email" id="business-email" required>

  <label for="business-phone">Phone Number:</label>
  <input type="text" id="business-phone" required>

  <label for="business-address">Address:</label>
  <input type="text" id="business-address" required>

  <label for="business-city">City:</label>
  <input type="text" id="business-city" required>

  <label for="business-state">State:</label>
  <select id="business-state" required>
    <option value="">Select State</option>
    <!-- Add all states here -->
  </select>

  <label for="business-zip">ZIP Code:</label>
  <input type="text" id="business-zip" required>

  <label for="tier-select">Select Tier:</label>
  <select id="tier-select" required>
    <option value="">Select a Tier</option>
    <option value="0.25">Founders’ Circle ($0.25/mo, billed $3/yr)</option>
    <option value="1">Dollar Bill ($1/mo, billed $12/yr)</option>
    <option value="2">Bread & Butter ($2/mo, billed $24/yr)</option>
    <option value="5">Startup Lane ($5/mo)</option>
    <option value="10">Builder’s Foundation ($10/mo)</option>
    <option value="20">Growth Track ($20/mo)</option>
    <option value="50">Pro Business ($50/mo)</option>
    <option value="100">Executive Class ($100/mo)</option>
  </select>

  <label for="payment-type">Payment Method:</label>
  <select id="payment-type" required>
    <option value="">Select Payment Method</option>
    <option value="paypal">PayPal</option>
    <option value="polygon">Polygon (USDC)</option>
    <option value="cash">Cash</option>
  </select>

  <label id="cash-code-label" for="cash-code" style="display:none;">Enter Cash Code:</label>
  <input type="text" id="cash-code" style="display:none;" placeholder="Enter transaction code">

  <label id="polygon-hash-label" for="polygon-hash" style="display:none;">Enter Polygon Transaction Hash:</label>
  <input type="text" id="polygon-hash" style="display:none;" placeholder="Enter Polygon tx hash">

  <div id="paypal-button-container" style="margin-top:20px;"></div>

  <button type="submit" id="submit-button">Submit & Pay</button>
</form>

<script src="https://www.paypal.com/sdk/js?client-id=AdefJjr7m6mZkDwKqt_nyTiOSRCXIThl2h41bgHzev27XWXZFLyGhXF7i8RIfM1ZDucgNVzkdb-w5bnd&currency=USD"></script>
<script>
const POLYGON_WALLET_ADDRESS = "0x3b8eB1C782F7f33525d34028B7E8fA50a214303f";
const MASTER_CASH_CODE = "YOUR_MASTER_CASH_CODE";

const tierSelect = document.getElementById('tier-select');
const paymentType = document.getElementById('payment-type');
const paypalContainer = document.getElementById('paypal-button-container');
const form = document.getElementById('quarterclub-form');
const cashCodeInput = document.getElementById('cash-code');
const cashCodeLabel = document.getElementById('cash-code-label');
const polygonHashInput = document.getElementById('polygon-hash');
const polygonHashLabel = document.getElementById('polygon-hash-label');

// Render PayPal Button
function renderPayPalButton(amount) {
  paypalContainer.innerHTML = "";
  if (!amount) return;

  paypal.Buttons({
    createOrder: function(data, actions) {
      return actions.order.create({ purchase_units: [{ amount: { value: amount } }] });
    },
    onApprove: function(data, actions) {
      return actions.order.capture().then(details => {
        alert('Transaction completed by ' + details.payer.name.given_name);
      });
    }
  }).render('#paypal-button-container');
}

// Show inputs/buttons based on payment type
paymentType.addEventListener('change', () => {
  const type = paymentType.value;
  paypalContainer.innerHTML = "";
  cashCodeInput.style.display = "none";
  cashCodeLabel.style.display = "none";
  polygonHashInput.style.display = "none";
  polygonHashLabel.style.display = "none";

  if(type === 'paypal' && tierSelect.value) {
    renderPayPalButton(tierSelect.value);
  } else if(type === 'polygon') {
    polygonHashInput.style.display = "block";
    polygonHashLabel.style.display = "block";

    const walletMessage = `Send payment to your Polygon Wallet:\n\n${POLYGON_WALLET_ADDRESS}\n\nClick OK to copy to clipboard.`;
    if (confirm(walletMessage)) {
      navigator.clipboard.writeText(POLYGON_WALLET_ADDRESS).then(() => {
        alert("Polygon address copied to clipboard. Paste it in the transaction hash field after payment.");
      }).catch(() => {
        alert("Could not copy automatically. Copy manually: " + POLYGON_WALLET_ADDRESS);
      });
    }
  } else if(type === 'cash') {
    cashCodeInput.style.display = "block";
    cashCodeLabel.style.display = "block";
    alert("Please enter your unique cash transaction code to complete payment.");
  }
});

// Re-render PayPal if tier changes
tierSelect.addEventListener('change', () => {
  if(paymentType.value === 'paypal') renderPayPalButton(tierSelect.value);
});

// Form submission
form.addEventListener('submit', async (e) => {
  e.preventDefault();

  const businessData = {
    name: document.getElementById('business-name').value,
    ein: document.getElementById('business-ein').value,
    email: document.getElementById('business-email').value,
    phone: document.getElementById('business-phone').value,
    address: document.getElementById('business-address').value,
    city: document.getElementById('business-city').value,
    state: document.getElementById('business-state').value,
    zip: document.getElementById('business-zip').value,
    tier: tierSelect.value,
    paymentType: paymentType.value,
    cashCode: cashCodeInput.value.trim(),
    polygonHash: polygonHashInput.value.trim()
  };

  // Ensure tier and payment type are selected
  if(!businessData.tier || !businessData.paymentType) {
    alert("Please select a tier and payment method.");
    return;
  }

  // Cash validation
  if(businessData.paymentType === 'cash') {
    if(businessData.cashCode !== MASTER_CASH_CODE) {
      alert("Invalid cash code. Payment cannot be completed.");
      return;
    }
  }

  // Polygon validation
  if(businessData.paymentType === 'polygon') {
    if(!businessData.polygonHash) {
      alert("Please enter the transaction hash for your Polygon payment.");
      return;
    }
  }

  // Optional: send to Worker API
  try {
    const response = await fetch('https://api.braxendevelopment.work/', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(businessData)
    });

    if(!response.ok) throw new Error('Network response was not ok');
    alert("Form submitted successfully. Thank you for joining The Quarter Club!");
  } catch(err) {
    console.error('Error submitting form:', err);
    alert("There was an error submitting your data. Please try again.");
  }
});
                                                      </script>
